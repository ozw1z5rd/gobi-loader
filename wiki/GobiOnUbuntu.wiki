#ubuntu 11.04

= Ubuntu 11.04 miss the support for my notebook =

I installed ubuntu 11.04 and nothing is working. 
The modem is not detected at all!

As first step add the following two rows into the /etc/modules files:
{{{
hp-wmi 
qcserial 
}}}
This is still not enough because the vendorID / deviceID used in my notebook are missing into the qcserial.ko driver.

I mean these numbers:
{{{
 oz@ubuntu:/usr/src/linux-source-2.6.38/linux-source-2.6.38/drivers/usb/serial$ lsusb 
 :
 .
 Bus 003 Device 002: ID 03f0:171d Hewlett-Packard Wireless (Bluetooth + WLAN)  Interface [Integrated Module]  
 -----------------------^^^^^^^^^
 :
 .
}}}

Let's add them and recompile qcserial.c: 
{{{
 apt-get install linux-source-2.6.38 
 cd /usr/src/linux-source-2.6.38 
 bunzip2 linux-source-2.6.38.tar.bz2
 tar xvf  linux-source-2.6.38.tar
 cd  linux-source-2.6.38/drivers/usb/serial
 vi qcserial.c 
}}}
Add this row :
{{{
       {USB_DEVICE(0x03f0, 0x171d)},   /* HP Gobi 2000 Modem device OZ  */ 

}}}
Open the MakeFile inside the same folder and add in top:
{{{
 obj-m = qcserial.o  
 KVERSION = $(shell uname -r) 
 all: 
 <press tab>make -C /lib/modules/$(KVERSION)/build M=$(PWD) modules 
 clean: 
 <press tab>make -C /lib/modules/$(KVERSION)/build M=$(PWD) clean 
}}}
Now
{{{
 make
}}}
after the compilation completes copy qcserial.ko in 
/lib/modules/2.6.38-8-generic/kernel/drivers/usb/serial/

After the reboot you will see the modem is detected and the ttyUSB0, ttyUSB1 and ttyUSB2 are made available:

{{{
[   66.143267] qcserial 1-2:1.1: Qualcomm USB modem converter detected
[   66.143355] usb 1-2: Qualcomm USB modem converter now attached to ttyUSB0
[   66.144809] qcserial 1-2:1.2: Qualcomm USB modem converter detected
[   66.144900] usb 1-2: Qualcomm USB modem converter now attached to ttyUSB1
[   66.145698] qcserial 1-2:1.3: Qualcomm USB modem converter detected
[   66.145767] usb 1-2: Qualcomm USB modem converter now attached to ttyUSB2
}}}

Loader still works but you have to start it after a cold boot, also I noticed any attempt to start again the loader will crash the device, this also happens if you are using wvdial with the incorrect ttyUSBx port.

The best this is to start the loader after the computer booted, then use the network manager to connet skipping the use of wvdial.

I also noticed sometimes the devices hangs and reboot, so you have to start again the loader.

